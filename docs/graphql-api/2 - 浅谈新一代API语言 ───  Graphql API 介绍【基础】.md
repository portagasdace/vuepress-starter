# GraphQL API 介绍

在这篇中我不会给大家介绍的多详细，主要是一些理念，大家先有个印象。至于一些类型或者方法我们在后续的实战中会讲到的。

## 什么是 API

API（Application Programming Interface，应用程序编程接口）是一些预先定义的函数或者接口，目的是提供应用程序与开发人员基于某软件或硬件得以访问一组例程的能力，而又无须访问源码，或理解内部工作机制的细节。

要实现一个 API 服务器，首先要考虑两个方面：API 风格和媒体类型。常用的 API 风格是 RPC 和 REST，常用的媒体类型是 JSON、XML 和 Protobuf。

## GraphQL 简介

GraphQL 是一种新的 API 标准，它提供了一种比 REST 更有效、更强大和更灵活的替代方案。它是由 **Facebook** 开发并开源的，现在由来自世界各地的公司和个人组成的大型社区维护。

> API已经成为软件基础结构中无处不在的组件。简而言之，API定义了客户客户端如何从服务器加载数据。

在其核心部分，GraphQL支持声明式数据获取，客户端可以在其中准确地指定需要从API获取哪些数据。与返回固定数据结构的多个端点（multiple endpoints）不同，GraphQL服务器只公开单个端点（a single endpoint），并使用客户机请求的准确数据进行响应。

除了Facebook，许多大公司都在采用GraphQL，包括GitHub，Pinterest，Twitter，Sky，纽约时报，Shopify，Yelp等数千家公司。

![](https://user-gold-cdn.xitu.io/2020/2/28/1708a4e40582e66d?w=984&h=399&f=png&s=200379)

## GraphQL vs REST

由于REST是构建API的一种流行方法，并且比GraphQL更广泛，我们假设你已经熟悉了，让我们看看GraphQL和REST之间的差异。

![](https://user-gold-cdn.xitu.io/2020/2/28/1708a50acd476b49?w=877&h=241&f=png&s=23338)

### REST是一个概念

REST是一个事实上的架构标准，但它实际上并没有规范和大量的非官方定义。GraphQL有一个规范草案，它是一种查询语言而不是一种体系结构，围绕着它构建了一套定义良好的工具（以及一个繁荣的生态系统）。

虽然REST建立在现有架构之上，而在最常见的场景中是HTTP，但另一方面，GraphQL正在构建自己的约定。这可能是一个优势点，因为REST通过在HTTP层上缓存而免费获益。

### 单个端点

GraphQL只有一个端点，你可以在其中发送所有查询。如果使用REST方法，你可以创建多个端点，并使用HTTP **动词**来区分读操作（`GET`）和写操作（`POST`，`PUT`，`DELETE`）。GraphQL不使用HTTP动词来确定请求类型。

![](https://user-gold-cdn.xitu.io/2020/2/28/1708a5208fb14994?w=814&h=408&f=png&s=20062)

### 根据你的需求量身定制

使用REST，你通常无法选择服务器返回给你的内容，除非服务器使用[稀疏字段集](http://jsonapi.org/format/#fetching-sparse-fieldsets)实现部分响应，并且客户端使用该功能。API维护者无法强制执行此类过滤。

API通常会向你返回比你需要的信息更多的信息，除非你也控制API服务器，并为每个不同的请求定制响应。

使用GraphQL，您可以明确地请求您需要的信息，您不能从完整的响应默认值中“选择退出”，只会强制选择您想要的字段。

这有助于节省服务器上的资源，因为你可能需要较少的处理流程以及很少的带宽，因为要传输的有效负载较小。

![](https://user-gold-cdn.xitu.io/2020/2/28/1708a516e40def33?w=836&h=454&f=png&s=106300)

### GraphQL 可以轻松监控字段的使用情况

使用REST，除非强制使用稀疏字段集，否则无法确定客户端是否使用了字段，因此在进行重构或弃用时，无法确定实际使用情况。

GraphQL可以跟踪客户端使用的字段。

### 访问嵌套数据资源

GraphQL允许生成少得多的网络调用。

我们举个例子：你需要访问一个人的朋友的名字。如果你的REST API公开了一个`/person`端点，该端点返回一个带有朋友列表的人物对象，你通常首先通过执行获取人员信息`GET /person/1`，其中包含其朋友的ID列表。

除非这个人的朋友列表已经包含朋友姓名，否则有100个朋友需要向`/person`端点发出101个HTTP请求，这是一个巨大的时间成本，也是一个资源密集型操作。

使用GraphQL，你只需要一个请求，该请求会询问这个人的朋友的姓名。

### 类型

REST API基于JSON，无法提供类型控制。**GraphQL有一个Type System**。

### 哪一个更好？

世界各地的组织正在质疑他们的API技术选择，他们正试图找出从REST迁移到GraphQL是否最适合他们的需求。

当你需要公开复杂的数据表示，以及客户端可能只需要数据的子集，或者他们定期执行嵌套查询以获取所需数据时，GraphQL非常适合。

与编程语言一样，没有单一的赢家，这完全取决于你的需求。

## 小结

本小节介绍了 GraphQL 基本概念 以及 GraphQL 与 REST 的对比。